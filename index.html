<html>
  <head>
    <title>My App</title>
    <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0, maximum-scale=1, user-scalable=no, minimal-ui">
	    
    <link rel="stylesheet" href="css/main.css"> /* cdn.kik.com/app/3.0.0/app.min.css */
    <link rel="apple-touch-icon" href="meta/App-logo.PNG">
    <meta name="apple-mobile-web-app-capable" content="yes"> 
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <style>
      /* put your styles here */
	    .fileuploadprgss {display:inline-block;width:100%;height: 10px;
		    padding:0px 0 0 0;margin:0;
		    margin-left: auto;
		    margin-right:auto;
		    background:none;border: 0;
		    border-radius: 15px;
		    text-align: center;
		    position:center;
		    font-family: Arial, Helvetica, sans-serif;font-size: 0.8em; 
	    }
	    .fileuploadprgss::-webkit-progress-bar {
		    height:8px;width:100%;
		    margin:0 auto;
		    background-color: #CCC;
		    border-radius: 15px;box-shadow:0px 0px 0px #777 inset; 
	    }
	    .fileuploadprgss::-webkit-progress-value {
		    display:inline-block;
		    float:left;
		    height:8px;
		    margin:0px -10px 0 0;
		    background: #00F1FF;
		    border-radius: 15px;
		    box-shadow:0px 0px 6px #777 inset; 
	    }
	    .fileuploadprgss:after {
		    margin:-26px 0 0 -7px;
		    padding:0;display:inline-block;
		    float:left;
		    content: attr(value) '%'; 
	    }
	    .p4img {
		    max-width: 200px;
		    
	    }
    </style>
  </head>
  <body>
    <div class="app-page" data-page="home">
      <div class="app-topbar">
        <div class="app-title">Home</div>
      </div>
      <div class="app-content">
        <div class="app-section">
          <div class="app-button" data-target="page2">About</div>
        </div>
        <div class="app-section">
          <div class="app-button" data-target="page3">LanyxSoft Messenger</div>
        </div>      
        <div class="app-section">
          <div class="app-button" data-target="page4">Login</div>
        </div>
      </div>
    </div>

    <div class="app-page" data-page="page2">
      <div class="app-topbar">
        <div class="app-button left" data-back data-autotitle></div>
        <div class="app-title">About</div>
      </div>
      <div class="app-content">
        Page 2 is boring
      </div>
    </div>	
    <div class="app-page" data-page="page3">
      <div class="app-topbar">
        <div class="app-button left" data-back data-autotitle></div>
        <div class="app-title"></div></div>
      <div class="app-content">
        
      </div>
    </div>
    <div class="app-page" data-page="page4">
      <div class="app-topbar">
        <div class="app-button left" data-back data-autotitle></div>
        <div class="app-title"></div></div>
      <div class="app-content">
        
	      <script src="https://www.gstatic.com/firebasejs/3.7.4/firebase.js"></script>
	      	
	      <progress class="fileuploadprgss" id="uploader" value="0" max="100">0%</progress>	
	      <input type="file" id="fileButton" value="upload"/>
	      <img class="p4img" src="" id="image">

      </div>
    </div>
    
<script src="/js/index.js"></script>
    <script src="//cdn.kik.com/app/3.0.0/app.min.js"></script>
    <script>
      App.controller('home', function (page) {
        // put stuff here
      });

      App.controller('page2', function (page) {
        // put stuff here
        alert("hi itch");
      });
      
      App.controller('page3', function (page) {
        // put stuff here 
	      
      });
	
      App.controller('page4', function (page) {
        // put stuff here      
      });

      try {
        App.restore();
      } catch (err) {
        App.load('home');
      }
	    
	     // Initialize Firebase
  var config = {
    apiKey: "AIzaSyAz0J5c0czjU3S2PddQdFxmnd52hGHqtWQ", authDomain: "fitbit-flex2-integration.firebaseapp.com",
    databaseURL: "https://fitbit-flex2-integration.firebaseio.com", projectId: "fitbit-flex2-integration",
    storageBucket: "fitbit-flex2-integration.appspot.com" };
  firebase.initializeApp(config);
  var uploader = document.getElementById('uploader');
  var fileButton = document.getElementById('fileButton');
  fileButton.addEventListener('change', function(e){
  var file = e.target.files[0];
  var storageRef = firebase.storage().ref('img/'+file.name);
  var task = storageRef.put(file);
  task.on('state_changed', function progress(snapshot) {
    var percentage = (snapshot.bytesTransferred/snapshot.totalBytes)*100;
    uploader.value = percentage;  
  }, function error(err) {
  },function complete() {
var starsRef = storageRef.child('images/');
// Get the download URL
	  starsRef.getDownloadURL();
	    
	  var promise1 = new Promise(function(resolve, reject) {resolve('');});
	  promise1.then(function(url) {
		  setTimeout(function(){alert("hello" + this.url)}, 9000); 
		  
		  var filepathforimg = file.name;
	  alert(filepathforimg);
          var img = document.getElementByid("image");
	  img.src = "https://firebasestorage.googleapis.com/v0/b/fitbit-flex2-integration.appspot.com/o/img%2" + filepathforimg + "?alt=media&token=6c380808-1ac1-432b-9944-befc912f6de8";
	  alert(img.src + "img.src");
		 
	  });
	  
});});      
	   
	    
    </script>
	</body>
</html>
