<html>
  <head>
    <title>LanyxSoft</title>	  
    <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0, maximum-scale=1, user-scalable=no, minimal-ui">
	    
    <link rel="stylesheet" href="css/main.css"> 
    <link rel="apple-touch-icon" href="meta/App-logo.PNG">
    <meta name="apple-mobile-web-app-capable" content="yes"> 
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
	  
    <style>
      /* put your styles here */
	    .fileuploadprgss {display:inline-block;width:100%;height: 10px;
		    padding:0px 0 0 0;margin:0;
		    margin-left: auto;
		    margin-right:auto;
		    background:none;border: 0;
		    border-radius: 15px;
		    text-align: center;
		    position:center;
		    font-family: Arial, Helvetica, sans-serif;font-size: 0.8em; 
	    }
	    .fileuploadprgss::-webkit-progress-bar {
		    height:8px;width:100%;
		    margin:0 auto;
		    background-color: #CCC;
		    border-radius: 15px;box-shadow:0px 0px 0px #777 inset; 
	    }
	    .fileuploadprgss::-webkit-progress-value {
		    display:inline-block;
		    float:left;
		    height:8px;
		    margin:0px -10px 0 0;
		    background: #00F1FF;
		    border-radius: 15px;
		    box-shadow:0px 0px 6px #777 inset; 
	    }
	    .fileuploadprgss:after {
		    margin:-26px 0 0 -7px;
		    padding:0;display:inline-block;
		    float:left;
		    content: attr(value) '%'; 
	    }
	    .hide {display: none;}
	    .p4img {
		    max-width: 300px;
	    }
	    .postcon {width: 450px; height: 600; background-color: lightgray; border-radius: 25px; align-items: center;}
	    .postcon:content {margin-left: 100px; margin-right: 100px;}
	    .lock {opacity: 0.5; -webkit-filter: blur(5px); filter: blur(5px); background-color: none; z-index: 100;}
	    
	    ul{ list-style: none; margin: 0; padding: 0; }
	    ul li{ display:inline-block; clear: both; padding: 20px; border-radius: 30px; margin-bottom: 2px; font-family: Helvetica, Arial, sans-serif; }
	    .him{ background: #e5e5e5; float: left; }
	    .me{ float: right; background: #0084ff; color: #fff; }
	    .him + .me{ border-bottom-right-radius: 5px; }
	    .me + .me{ border-top-right-radius: 5px; border-bottom-right-radius: 5px; }
	    .me:last-of-type { border-bottom-right-radius: 30px; }
	    .msgsendbtn {bottom: 10; right: 10px; float: bottom; color: blue; width: 100px; }		    
	    embed {width: 100%; height: 80%;}	    
	    
	    input[type="text"]:disabled {background: #dddddd;} 
	    .full-screen-cover {border:none; -webkit-filter: blur(1px); position:absolute; overflow:auto; width:100%; height:100%; opacity: 0.8; background-color:darkgray; z-index:77;}
	    .full-screen-cover.show {display:none; }
	    
	    .consolelogs {word-wrap:break-word; white-space: nowrap; text-overflow: ellipsis; overflow: hidden; font-size: 25px; background: #333; max-width: 75ch; min-height: 100%; height: 100% auto;}
	    .log-boolean {color: orange;}
	    .log-undefined {color: red;}
	    .log-object {color: lime;} 
	    .log-date {color: pink;}
	    .log-string {color: white;}
	    .log-number {color: cyan;}
	    
	    
	    
	    
	    
	     html {
   font-family:'Open Sans', 'Lucida Grande', Arial, Helvetica, sans-serif;
 }

.mdn-disclaimer {font-family:'Open Sans', 'Lucida Grande', Arial, Helvetica, sans-serif; font-size:18px; background-color: #ddd;
  color: black; margin-left: 80px; margin-right: 80px; max-width: 620px; padding: 12px; border-radius: 5px; border: 1px solid black; box-shadow: 1px 1px 2px black;
}

.mdn-footer {font-weight:normal; font-size:12px; font-family:'Lucida Grande', Arial, Helvetica, sans-serif;
	text-align:right; border-top:2px solid #000000;
}
	    
	    

    </style>
  </head>
  <body>
    <div class="app-page" data-page="home">
      <div class="app-topbar">
        <div class="app-title">Home</div>
      </div>
      <div class="app-content">
        <div class="app-section">
          <div class="app-button" data-target="page2">About</div>
        </div>
        <div class="app-section">
          <div class="app-button" data-target="page3">LanyxSoft Messenger</div>
        </div>      
        <div class="app-section">
          <div class="app-button" data-target="page4">Social</div>
        </div>
	<div class="app-section">
          <div class="app-button" data-target="page5">Login</div>
        </div>
	<div class="app-section">
          <div class="app-button" data-target="page6">Messenger</div>
        </div>
	<div class="app-section">
          <div class="app-button" data-target="settings">Settings</div>	    
        </div>
	<div class="app-section">
          <div class="app-button" data-target="control-center">Control Pannel</div>	    
        </div>
      </div>
    </div>

    <div class="app-page" data-page="page2">
      <div class="app-topbar">
        <div class="app-button left" data-back data-autotitle></div>
        <div class="app-title">About</div>
      </div>
      <div class="app-content">
        Page 2 is boring	      
      </div>
    </div>	
    <div class="app-page" data-page="page3">	    
      <div class="app-topbar">
        <div class="app-button left" data-back data-autotitle></div>	      
        <div class="app-title"></div></div>
      <div class="app-content">	   	      
        <ul id="listings">
		
		<li class="him">By Other User</li>
		<li class="me">By this User, first message</li>
		<li class="me">By this User, secondmessage</li>
		<li class="me">By this User, third message</li>
		<li class="me">By this User, fourth message</li>
		<li class="him">By Other User</li>
			<input id="msg" placeholder="message">
	      <div onclick="activate()" class="msgsendbtn">Send</div>	
	</ul>	      
      </div>
    </div>
    <div class="app-page" data-page="page4">
	    <progress class="fileuploadprgss" id="uploader" value="0" max="100">0%</progress>	
      <div class="app-topbar">
        <div class="app-button left" data-back data-autotitle></div>
        <div class="app-title"></div></div>
      <div id="p4" class="app-content">
        
	      <script src="https://www.gstatic.com/firebasejs/3.7.4/firebase.js"></script>	      	
	      
	      <input type="file" id="fileButton" value="upload"/>
              <img class="p4img" src="" id="image">
	      <div class="postcon" id="postcont"></div>
      </div>
    </div>
    <div class="app-page" data-page="page5">
      <div class="app-topbar">
        <div class="app-button left" data-back data-autotitle></div>
        <div class="app-title"></div></div>
      <div class="app-content">
	      <div onclick="ble()">search</div>
     </div>
   </div>
   <div class="app-page" data-page="page6">
      <div class="app-topbar">
        <div class="app-button left" data-back data-autotitle></div>
        <div class="app-title">websocket</div>
      </div>
      <div class="app-content">
	      
	      
	<head>
  <title>WebSocket Chat Demo</title>
  <meta charset="utf-8">
  <script src="/Websocket/chatclient.js"></script>	     
</head>
<body>
  <p>This is a simple chat system implemented using WebSockets. It works by sending packets of JSON back and forth with the server.</p>
  <p class="mdn-disclaimer">This text and audio/video chat example is offered as-is
    for demonstration purposes only, and should not be used for any other
    purpose.</p>
  <p>Enter a username: <input id="name" type="text" maxlength="12" placeholder="Your name">
  <input type="button" name="login" value="Log in" onclick="connect()"></p>
  <table border="0" width="100%">
  <tr height="100%">
  <td width="120px" align="top" border="1" height="100%">
  <div id="userlistbox" style="border: 1px solid black; width:100%; height:100%;"></div>
  </td>
  <td>
  <iframe width="100%" height="400px" id="chatbox"></iframe>
  <tr>
  <td>&nbsp;</td>
  <td>
  <p>
  Chat: <input id="text" type="text" name="text" size="80" maxlength="256" placeholder="Chat with us!" autocomplete="off" onkeyup="handleKey(event)" disabled>
  <input type="button" id="send" name="send" value="Send" onclick="send()" disabled></p></td>
  </td>
  </tr>
  </table>
</body>      
	 							  
									  
      </div>
    </div>	
    <div class="app-page" data-page="settings">
      <div class="app-topbar">
        <div class="app-button left" data-back data-autotitle></div>
        <div class="app-title">Settings</div>
      </div>
      <div class="app-content">
	      <div class="app-section">
                <div class="app-button" data-target="settingsp1">General</div>
              </div>
	      
      </div>
    </div>	
    <div class="app-page" data-page="settingsp1">    
		      <div class="app-topbar">       
		        <div class="app-button left" data-back data-autotitle></div>       
		        <div class="app-title">Settings > General</div>      
		      </div>
		      <div class="app-content">     
			      
      </div>     
    </div>	      
    <div class="app-page" data-page="control-center">
    	    <div class="app-topbar">		    	    
          <div class="app-button left" data-back data-autotitle></div>
			    <div class="app-title">Base 17</div>
       	    </div>     	    	    
	    <div class="app-content">      
		    <div class="consolelogs">		    
			    <pre id="logger"></pre>			    
			    
			    <script>								    
				    
				    (function (logger) {
    console.old = console.log;
    console.log = function () {
        var output = "", arg, i;
        for (i = 0; i < arguments.length; i++) {
            arg = arguments[i];
            output += "<span class=\"log-" + (typeof arg) + "\">";
            if (
                typeof arg === "object" &&
                typeof JSON === "object" &&
                typeof JSON.stringify === "function"
            ) {
                output += JSON.stringify(arg);   
            } else {
                output += arg;   
            }
            output += "</span>&nbsp;";
        }
        logger.innerHTML += output + "<br>";
        console.old.apply(undefined, arguments);
    };
})(document.getElementById("logger"));

// Testing
console.log("Hi!", {a:3, b:6}, 42, true);
console.log("Multiple", "arguments", "here");
console.log(null, undefined);
console.log(navigator.platform,navigator.userAgent, new Date());
console.log("Platform:", navigator.platform);
console.log("is online:", navigator.onLine);
console.log("device language:", navigator.language);				    
				    
				    
				    
			    </script>
		    </div>
	    </div>
    </div>	

<script src="https://lanyxsofthtmlcode.weebly.com/uploads/9/5/7/3/95731436/app.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.2.0/firebase.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://lanyxsofthtmlcode.weebly.com/uploads/9/5/7/3/95731436/index.js_for_webapp.js"</script>
</div>
</div>
	      
      </div>
    </div>
    
<script src="/js/index.js"></script>
    <script src="//cdn.kik.com/app/3.0.0/app.min.js"></script>
    <script>
      App.controller('home', function (page) {
        // put stuff here
      });
      App.controller('page2', function (page) {
        // put stuff here	      	      
      });
      App.controller('page3', function (page) {
        // put stuff here	      	   
	      window.scrollTo(0, document.body.scrollHeight || document.documentElement.scrollHeight);
      });
      App.controller('page4', function (page) {
        // put stuff here      
      });
      App.controller('page5', function (page) {
        // put stuff here      	      
      });
      App.controller('page6', function (page) {
        // put stuff here      	      
	      
      });
      App.controller('settings', function (page) {
        // put stuff here      	      
      });
	    App.controller('settingsp1', function (page) {        
		    // put stuff here      			    
	    });
      App.controller('control-center', function (page) {
        // put stuff here      	      
      });


      try {
        App.restore();
      } catch (err) {
        App.load('home');
      }
	    
	     // Initialize Firebase
  var config = {
    apiKey: "AIzaSyAz0J5c0czjU3S2PddQdFxmnd52hGHqtWQ", authDomain: "fitbit-flex2-integration.firebaseapp.com",
    databaseURL: "https://fitbit-flex2-integration.firebaseio.com", projectId: "fitbit-flex2-integration",
    storageBucket: "fitbit-flex2-integration.appspot.com" };
  firebase.initializeApp(config);
	    //content items
	    var uploader = document.getElementById('uploader');
	    var postimg = document.getElementById('image');
	    var fileButton = document.getElementById('fileButton');
	    function progresstracker() {    
			    var int = 0;
			    if (int == 0) {
				    int = 1;			    
				    uploader.classList.toggle("hide");
			    } else {
				    int = 0;
				    uploader.classList.remove("hide");
			    }}
	    progresstracker();
	    fileButton.addEventListener('change', function(e){ 	 
		    var file = e.target.files[0];	  	
		    var storage = firebase.storage();
		    var storageRef = firebase.storage().ref('img/' + file.name);
		    var task = storageRef.put(file);
		    progresstracker();
		    
  task.on('state_changed', function progress(snapshot) {
    var percentage = (snapshot.bytesTransferred/snapshot.totalBytes)*100;
    uploader.value = percentage;  
  }, function error(err) {},
  function complete() {
	  var downloadURL =task.snapshot.downloadURL; 
	  //alert(downloadURL);
	  postimg.src = downloadURL;
	  progresstracker();
	  var post = document.createElement("IMG");
	  var postcon = document.createElement("postcon");	   
	  postcon.style.backgroundColor = "darkgray";
	  postcon.style.borderRadius = "25px";	  
	  postcon.appendChild(post);
	  document.getElementById('postcont').appendChild(postcon);
    post.setAttribute("src", downloadURL);	
	  post.width = "400";	  	  
	  	    
  });  });	   	    
	    
	      var node = document.createElement("LI");	
	    function activate() {		    		    
	      var message = document.getElementById("msg");
	      //var node = document.createElement("LI");
	      node = document.createElement("LI");	 
	      node.classList.add("me");
	      node.innerHTML = message.value;	      
	      document.getElementById("listings").appendChild(node);
	      }
	    
	    
	    

	    
	    
	    
	    "use strict";
var connection = null;
var clientID = 0;

var WebSocket = WebSocket || MozWebSocket;

function setUsername() {
  var msg = {
    name: document.getElementById("name").value,
    date: Date.now(),
    id: clientID,
    type: "username"
  };
  connection.send(JSON.stringify(msg));
}

function connect() {
  var serverUrl = "ws://" + window.location.hostname + ":6502";

  connection = new WebSocket(serverUrl);

  connection.onopen = function(evt) {
    document.getElementById("text").disabled = false;
    document.getElementById("send").disabled = false;
  };

  connection.onmessage = function(evt) {
    var f = document.getElementById("chatbox").contentDocument;
    var text = "";
    var msg = JSON.parse(evt.data);
    var time = new Date(msg.date);
    var timeStr = time.toLocaleTimeString();

    switch(msg.type) {
      case "id":
        clientID = msg.id;
        setUsername();
        break;
      case "username":
        text = "<b>User <em>" + msg.name + "</em> signed in at " + timeStr + "</b><br>";
        break;
      case "message":
        text = "(" + timeStr + ") <b>" + msg.name + "</b>: " + msg.text + "<br>";
        break;
      case "rejectusername":
        text = "<b>Your username has been set to <em>" + msg.name + "</em> because the name you chose is in use.</b><br>";
        break;
      case "userlist":
        var ul = "";
        var i;

        for (i=0; i < msg.users.length; i++) {
          ul += msg.users[i] + "<br>";
        }
        document.getElementById("userlistbox").innerHTML = ul;
        break;
    }

    if (text.length) {
      f.write(text);
      document.getElementById("chatbox").contentWindow.scrollByPages(1);
    }
  };
}

function send() {
  var msg = {
    text: document.getElementById("text").value,
    type: "message",
    id: clientID,
    date: Date.now()
  };
  connection.send(JSON.stringify(msg));
  document.getElementById("text").value = "";
}

function handleKey(evt) {
  if (evt.keyCode === 13 || evt.keyCode === 14) {
    if (!document.getElementById("send").disabled) {
      send();
    }
  }
}
	    
"use strict";

var http = require('http');
var url = require('url');
var fs = require('fs');
var WebSocketServer = require('websocket').server;

var connectionArray = [];
var nextID = Date.now();
var appendToMakeUnique = 1;

var server = http.createServer(function(request, response) {
    console.log((new Date()) + " Received request for " + request.url);
    response.writeHead(404);
    response.end();
});

server.listen(6502, function() {
    console.log((new Date()) + " Server is listening on port 6502");
});

// Create the WebSocket server

var wsServer = new WebSocketServer({
    httpServer: server,
    autoAcceptConnections: true // You should use false here!
});

function originIsAllowed(origin) {
  // This is where you put code to ensure the connection should
  // be accepted. Return false if it shouldn't be.
  return true;
}

function isUsernameUnique(name) {
  var isUnique = true;
  var i;

  for (i=0; i<connectionArray.length; i++) {
    if (connectionArray[i].username === name) {
      isUnique = false;
      break;
    }
  }
  return isUnique;
}

function getConnectionForID(id) {
  var connect = null;
  var i;

  for (i=0; i<connectionArray.length; i++) {
    if (connectionArray[i].clientID === id) {
      connect = connectionArray[i];
      break;
    }
  }

  return connect;
}

function makeUserListMessage() {
  var userListMsg = {
    type: "userlist",
    users: []
  };
  var i;

  // Add the users to the list

  for (i=0; i<connectionArray.length; i++) {
    userListMsg.users.push(connectionArray[i].username);
  }

  return userListMsg;
}

function sendUserListToAll() {
  var userListMsg = makeUserListMessage();
  var userListMsgStr = JSON.stringify(userListMsg);
  var i;

  for (i=0; i<connectionArray.length; i++) {
    connectionArray[i].sendUTF(userListMsgStr);
  }
}

wsServer.on('connect', function(connection) {
//  if (!originIsAllowed(connection.origin)) {
//    request.reject();
//    console.log((new Date()) + "Connection from " + connection.origin + " rejected.");
//    return;
//  }
  
  console.log((new Date()) + " Connection accepted.");
  connectionArray.push(connection);

  // Send the new client its token; it will
  // respond with its login username.

  connection.clientID = nextID;
  nextID++;

  var msg = {
    type: "id",
    id: connection.clientID
  };
  connection.sendUTF(JSON.stringify(msg));

  // Handle the "message" event received over WebSocket. This
  // is a message sent by a client, and may be text to share with
  // other users or a command to the server.

  connection.on('message', function(message) {
      if (message.type === 'utf8') {
          console.log("Received Message: " + message.utf8Data);

          // Process messages

          var sendToClients = true;
          msg = JSON.parse(message.utf8Data);
          var connect = getConnectionForID(msg.id);

          switch(msg.type) {
            case "message":
              msg.name = connect.username;
              msg.text = msg.text.replace(/(<([^>]+)>)/ig,"");
              break;
            case "username":
              var nameChanged = false;
              var origName = msg.name;

              while (!isUsernameUnique(msg.name)) {
                msg.name = origName + appendToMakeUnique;
                appendToMakeUnique++;
                nameChanged = true;
              }

              if (nameChanged) {
                var changeMsg = {
                  id: msg.id,
                  type: "rejectusername",
                  name: msg.name
                };
                connect.sendUTF(JSON.stringify(changeMsg));
              }

              connect.username = msg.name;
              sendUserListToAll();
              break;
          }

          // Convert the message back to JSON and send it out
          // to all clients.

          if (sendToClients) {
            var msgString = JSON.stringify(msg);
            var i;

            for (i=0; i<connectionArray.length; i++) {
              connectionArray[i].sendUTF(msgString);
            }
          }
      }
  });
  
  // Handle the WebSocket "close" event; this means a user has logged off
  // or has been disconnected.
  
  connection.on('close', function(connection) {
    connectionArray = connectionArray.filter(function(el, idx, ar) {
      return el.connected;
    });
    sendUserListToAll();  // Update the user lists
    console.log((new Date()) + " Peer " + connection.remoteAddress + " disconnected.");
  });
});
	    
	    
	    
	    
    </script>
	</body>
</html>
